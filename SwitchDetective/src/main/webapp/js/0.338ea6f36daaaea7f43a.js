webpackJsonp([0],{"3+Wi":function(t,e){},"48mF":function(t,e){},NsM9:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n={props:{index:null,imgSrc:null,imgName:null,choosed:null},data:function(){return{currentDate:new Date}},computed:{selectAll:function(){return this.$store.getters.selectAll}},methods:{removeThis:function(t){this.$emit("remove-item",this.index),t.stopPropagation()},changeChoose:function(){var t={choosed:!this.choosed,index:this.index};this.$emit("choose-changed",t)}}},s={render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{class:[t.choosed?"item-choosed":""],staticStyle:{position:"relative",right:"10%","margin-bottom":"10%"},on:{click:function(e){return t.changeChoose()}}},[i("el-card",{attrs:{"body-style":{padding:"0px"}}},[i("img",{staticClass:"image",attrs:{src:t.imgSrc}}),t._v(" "),i("div",{staticStyle:{padding:"14px"}},[i("span",[t._v(t._s(t.imgName))]),t._v(" "),i("div",{staticClass:"bottom"},[i("el-button",{staticClass:"button",attrs:{type:"text",icon:"el-icon-delete"},on:{click:t.removeThis}})],1)])])],1)},staticRenderFns:[]};var a={data:function(){return{index:1,imgList:[],choosedCount:0,selectAll:!1,isIndeterminate:!1}},components:{thumbnailItem:i("VU/8")(n,s,!1,function(t){i("vkan")},"data-v-c747eb62",null).exports},computed:{identityButtonDisable:function(){return 0===this.choosedCount||0===this.imgList.length},checkBoxDisabled:function(){return 0===this.imgList.length},clearButtonDisabled:function(){return 0===this.imgList.length}},watch:{choosedCount:function(t,e){t===this.imgList.length&&0!==t?(this.selectAll=!0,this.isIndeterminate=!1):0===t?(this.selectAll=!1,this.isIndeterminate=!1):t!=this.imgList.length&&(this.selectAll=!1,this.isIndeterminate=!0)}},methods:{errorFileMessage:function(t){this.$message.error(t+"上传失败")},handleInvalidFile:function(t){for(var e="<ul>",i=0;i<t.length;i++)"form"===t[i].error?e+="<li style='list-style: none;'>"+t[i].name+"上传失败，格式错误。</li>":e+="<li style='list-style: none;'>"+t[i].name+"上传失败，大小不能超过5M。</li>";e+="</ul>",this.$message.error({message:e,dangerouslyUseHTMLString:!0,duration:0,showClose:!0})},getFile:function(t){for(var e=this,i=this,n=t.target.files,s=[],a=function(t){var a=n[t].name;if(!1===new RegExp("^.*?.(jpeg|jpg|png)$","gi").test(a))return s.push({name:a,error:"form"}),"continue";if(n[t].size>5242880)return s.push({name:a,error:"size"}),"continue";var o=e.imgList,l=n[t],r=new FileReader;r.onload=function(){var t=r.result;null!==t?o.push({index:i.index++,file:l,url:t,name:a,choosed:!1}):console.log("error")},r.readAsDataURL(n[t])},o=0;o<n.length;o++)a(o);0!==s.length&&this.handleInvalidFile(s)},removeThumbnailItem:function(t){for(var e=null,i=0;i<this.imgList.length;i++)if(this.imgList[i].index===t){e=i;break}null!==e&&(this.imgList.splice(e,1),this.choosedCount--)},updateChoosed:function(t){for(var e=0;e<this.imgList.length;e++)if(this.imgList[e].index===t.index){this.imgList[e].choosed=t.choosed,this.choosedCount+=t.choosed?1:-1;break}},clearList:function(){this.imgList.splice(0,this.imgList.length),this.index=1,this.choosedCount=0},setSelectAll:function(t){if(this.isIndeterminate=!1,this.selectAll){for(var e=0;e<this.imgList.length;e++)this.imgList[e].choosed=!0;this.choosedCount=this.imgList.length}else{for(var i=0;i<this.imgList.length;i++)this.imgList[i].choosed=!1;this.choosedCount=0}},identity:function(){var t=this,e=this.$loading({lock:!0,text:"识别中",spinner:"el-icon-loading",background:"rgba(0, 0, 0, 0.7)",target:".el-card"}),i=this.imgList,n=this.choosedCount,s=0;i.forEach(function(a,o){a.choosed&&t.$store.dispatch("identity",{file:a.file,base64:a.url}).then(function(t){console.log(t.data)}).catch(function(t){console.log(t)}).finally(function(){var o=i.indexOf(a);i.splice(o,1),t.choosedCount--,++s===n&&e.close()})})}}},o={render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",[i("el-card",{ref:"boxCard",staticClass:"box-card"},[i("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[i("el-checkbox",{staticStyle:{float:"left","margin-top":"-3%"},attrs:{id:"selectAllCheckBox",disabled:t.checkBoxDisabled,indeterminate:t.isIndeterminate},on:{change:t.setSelectAll},model:{value:t.selectAll,callback:function(e){t.selectAll=e},expression:"selectAll"}}),t._v(" "),i("el-popover",{staticStyle:{float:"right","margin-top":"-3%"},attrs:{placement:"bottom",title:"提示"}},[i("i",{staticClass:"el-icon-question",attrs:{slot:"reference"},slot:"reference"})])],1),t._v(" "),i("div",{directives:[{name:"show",rawName:"v-show",value:0===t.imgList.length,expression:"imgList.length === 0"}],staticClass:"mask"},[i("span",{staticStyle:{"font-size":"125%"}},[t._v("通过拍照或上传添加图片")])]),t._v(" "),i("div",{staticClass:"view-container"},[i("ul",{staticStyle:{overflow:"auto"}},t._l(t.imgList,function(e){return i("thumbnailItem",{key:e.index,tag:"li",attrs:{index:e.index,imgSrc:e.url,imgName:e.name,choosed:e.choosed},on:{"remove-item":t.removeThumbnailItem,"choose-changed":t.updateChoosed}})}),1)])]),t._v(" "),i("div",{staticStyle:{"margin-top":"10%"},attrs:{id:"button-container"}},[i("input",{ref:"fileInput",staticStyle:{display:"none"},attrs:{type:"file",accept:"image/*",multiple:""},on:{change:t.getFile}}),t._v(" "),i("div",{staticClass:"row1",staticStyle:{"margin-bottom":"8%"}},[i("el-button",{staticStyle:{position:"relative",left:"-5%"},attrs:{type:"primary",icon:"el-icon-camera",plain:"",round:""}},[t._v("拍照")]),t._v(" "),i("el-button",{staticStyle:{position:"relative",right:"-5%"},attrs:{type:"primary",icon:"el-icon-upload2",plain:"",round:""},on:{click:function(e){return t.$refs.fileInput.click()}}},[t._v("上传")])],1),t._v(" "),i("div",{staticClass:"row2"},[i("el-popconfirm",{staticStyle:{position:"relative",left:"-5%"},attrs:{confirmButtonText:"确定",cancelButtonText:"取消",icon:"el-icon-info",iconColor:"red",title:"确定要清空列表吗？"},on:{onConfirm:function(e){return t.clearList()}}},[i("el-button",{attrs:{slot:"reference",type:"primary",icon:"el-icon-delete",disabled:t.clearButtonDisabled,plain:"",round:""},slot:"reference"},[t._v("清空")])],1),t._v(" "),i("el-button",{staticStyle:{position:"relative",right:"-5%","margin-left":"10px"},attrs:{type:"primary",icon:"el-icon-view",disabled:t.identityButtonDisable,plain:"",round:""},on:{click:t.identity}},[t._v("识别")])],1)])],1)},staticRenderFns:[]};var l=i("VU/8")(a,o,!1,function(t){i("phgo")},"data-v-22d8445a",null).exports,r={data:function(){return{activeName:"uploadPart"}},computed:{imgMngrDlgVsbl:function(){return this.$store.getters.imgMngrDlgVsbl}},components:{thumbnail:l},methods:{closeDialog:function(){this.$emit("close-dialog")},handleClose:function(t){this.$store.dispatch("setImgMngrDlgVsbl",!1)},handleClick:function(t,e){}}},c={render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",[i("el-dialog",{attrs:{visible:t.imgMngrDlgVsbl,width:"70%","before-close":t.handleClose},on:{"update:visible":function(e){t.imgMngrDlgVsbl=e}}},[i("div",[i("el-tabs",{on:{"tab-click":t.handleClick},model:{value:t.activeName,callback:function(e){t.activeName=e},expression:"activeName"}},[i("el-tab-pane",{attrs:{label:"上传预览",name:"uploadPart"}},[i("thumbnail")],1),t._v(" "),i("el-tab-pane",{attrs:{label:"识别结果",name:"resultPart"}},[t._v("识别")])],1)],1)])],1)},staticRenderFns:[]},d=i("VU/8")(r,c,!1,null,null,null).exports,u={props:{result:null},data:function(){return{activeNames:["information","compare","inconsistent"],matrixRow:0,matrixColumn:0,state:{on:"投",off:"退",nothing:"备"}}},computed:{switchsArr:function(){var t=null,e=this.result.switchs,i=(e.length,0),n=0;e.forEach(function(t,e){i=Math.max(i,t.dotDetected.row),n=Math.max(n,t.dotDetected.column)}),this.matrixRow=i,this.matrixColumn=n,t=new Array;for(var s=0;s<=i;s++){t[s]=new Array;for(var a=0;a<=n;a++)t[s][a]=null}return e.forEach(function(e,i){t[e.dotDetected.row][e.dotDetected.column]=e}),t},switchsMatrix:function(){for(var t="",e=0;e<=this.matrixRow;e++)for(var i=0;i<=this.matrixColumn;i++){var n=this.switchsArr[e][i];null!==n&&(n.correct?t+="<span>"+this.state[n.dotDetected.state]+"</span>":t+="<span style='color: red'>"+this.state[n.dotDetected.state]+"</span>",i===this.matrixColumn?t+="<br/>":t+=" ")}return t},inconsistentSwitchs:function(){var t=this,e=[];return this.result.switchs.forEach(function(i,n){i.aSwitch&&!i.correct&&e.push({id:i.aSwitch.id,name:i.aSwitch.name,standardState:t.state[i.aSwitch.standardState],returnState:t.state[i.dotDetected.state]})}),e}},methods:{goBack:function(){this.$emit("close-dialog")},initSwitchsArr:function(){var t=this,e=this.result.switchs,i=(e.length,0),n=0;e.forEach(function(t,e){i=Math.max(i,t.dotDetected.row),n=Math.max(n,t.dotDetected.column)}),this.matrixRow=i,this.matrixColumn=n,this.switchsArr=new Array;for(var s=0;s<=i;s++){this.switchsArr[s]=new Array;for(var a=0;a<=n;a++)this.switchsArr[s][a]=null}e.forEach(function(e,i){t.switchsArr[e.dotDetected.row][e.dotDetected.column]=e})}}},h={render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",[i("div",{staticStyle:{position:"absolute",top:"5%",width:"90%",left:"5%"},attrs:{id:"result-item-header"}},[i("el-page-header",{attrs:{content:"详情"},on:{back:t.goBack}})],1),t._v(" "),i("div",{staticStyle:{width:"100%",height:"400px",overflow:"scroll"},attrs:{id:"result-item-main"}},[i("el-collapse",{model:{value:t.activeNames,callback:function(e){t.activeNames=e},expression:"activeNames"}},[i("el-collapse-item",{attrs:{title:"识别信息",name:"information"}},[i("div",{attrs:{id:"info"}},[i("p",[i("span",[t._v("屏柜号：")]),t._v("\n            "+t._s(t.result.cabinetId)+"\n          ")]),t._v(" "),i("p",[i("span",[t._v("识别时间：")]),t._v("\n            "+t._s(t.result.dateTime)+"\n          ")]),t._v(" "),i("p",[i("span",[t._v("是否与原始库一致:")]),t._v("\n            "+t._s(t.result.consistent?"一致":"不一致")+"\n          ")])])]),t._v(" "),i("el-collapse-item",{attrs:{title:"状态矩阵",name:"compare"}},[i("div",{staticStyle:{position:"relative"},attrs:{id:"orginImg"}},[i("div",{staticClass:"mask",staticStyle:{position:"absolute",width:"80%","margin-left":"10%"}},[t._v("原图")]),t._v(" "),i("el-image",{staticStyle:{width:"80%"},attrs:{src:t.result.originImg}},[i("div",{staticClass:"image-slot",attrs:{slot:"placeholder"},slot:"placeholder"},[t._v("\n              加载中\n              "),i("span",{staticClass:"dot"},[t._v("...")])])])],1),t._v(" "),i("div",{staticStyle:{position:"relative",width:"80%","margin-left":"10%","margin-top":"5%"},attrs:{id:"resultMatrix"}},[i("div",{staticClass:"mask",staticStyle:{position:"absolute",width:"100%"}},[t._v("状态矩阵")]),t._v(" "),i("el-card",{ref:"switchsMatrixCard",staticClass:"box-card"},[i("div",{staticStyle:{"margin-top":"10%"},domProps:{innerHTML:t._s(t.switchsMatrix)}})])],1)]),t._v(" "),i("el-collapse-item",{attrs:{title:"非一致数据",name:"inconsistent"}},[i("el-table",{staticStyle:{width:"100%"},attrs:{data:t.inconsistentSwitchs,border:""}},[i("el-table-column",{attrs:{prop:"id",label:"编号",width:"65"}}),t._v(" "),i("el-table-column",{attrs:{prop:"name",label:"名称",width:"95"}}),t._v(" "),i("el-table-column",{attrs:{prop:"standardState",label:"原始状态",width:"50"}}),t._v(" "),i("el-table-column",{attrs:{prop:"returnState",label:"识别结果",width:"50"}})],1)],1)],1)],1)])},staticRenderFns:[]};var m={data:function(){return{tableData:[{cabinetId:1}],multipleSelection:[],dialogVisible:!1,openRow:null,operations:["详情","确认","删除"],operationsToFunction:{"详情":this.checkDetailOp,"确认":this.confirmOp,"删除":this.deleteOp}}},components:{resultItem:i("VU/8")(u,h,!1,function(t){i("3+Wi"),i("48mF")},"data-v-d2810462",null).exports},computed:{newResult:function(){return this.$store.getters.newResult}},watch:{newResult:function(t,e){if(null!==t){var i=t;i.consistent=i.switchs.every(function(t,e,i){return t.correct}),this.tableData.push(i),console.log(i)}}},methods:{toggleSelection:function(t){var e=this;t?t.forEach(function(t){e.$refs.multipleTable.toggleRowSelection(t)}):this.$refs.multipleTable.clearSelection()},handleSelectionChange:function(t){this.multipleSelection=t},deleteAll:function(){this.tableData.splice(0,this.tableData.length)},filterTag:function(t,e){return e.consistent===t},paramsObject:function(t,e,i){return{op:t,index:e,row:i}},checkDetailOp:function(t,e){this.openRow=e,this.dialogVisible=!0},confirmOp:function(t,e){},deleteOp:function(t,e){this.tableData.splice(t,1)},handleCommand:function(t){this.operationsToFunction[t.op](t.index,t.row)}}},p={render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",[i("div",{staticStyle:{height:"350px"}},[i("el-table",{ref:"multipleTable",staticStyle:{width:"100%"},attrs:{data:t.tableData,"tooltip-effect":"dark","max-height":"350"},on:{"selection-change":t.handleSelectionChange}},[i("el-table-column",{attrs:{type:"selection",width:"40"}}),t._v(" "),i("el-table-column",{attrs:{prop:"cabinetId",label:"屏柜号",width:"70"}}),t._v(" "),i("el-table-column",{attrs:{prop:"consistent",label:"结果",width:"90",filters:[{text:"一致",value:!0},{text:"不一致",value:!1}],"filter-method":t.filterTag,"filter-placement":"bottom-end"},scopedSlots:t._u([{key:"default",fn:function(e){return[i("el-tag",{attrs:{type:!0===e.row.consistent?"success":"danger","disable-transitions":""}},[t._v(t._s(!0===e.row.consistent?"一致":"不一致"))])]}}])}),t._v(" "),i("el-table-column",{attrs:{label:"操作",width:"100"},scopedSlots:t._u([{key:"default",fn:function(e){return[i("el-dropdown",{attrs:{trigger:"click"},on:{command:t.handleCommand}},[i("el-button",{attrs:{type:"text"}},[t._v("\n              操作\n              "),i("i",{staticClass:"el-icon-arrow-down el-icon--right"})]),t._v(" "),i("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},t._l(t.operations,function(n){return i("el-dropdown-item",{key:n,attrs:{command:t.paramsObject(n,e.$index,e.row)}},[t._v(t._s(n))])}),1)],1)]}}])})],1),t._v(" "),i("el-dialog",{attrs:{visible:t.dialogVisible,width:"80%","show-close":!1},on:{"update:visible":function(e){t.dialogVisible=e}}},[i("resultItem",{attrs:{result:t.openRow},on:{"close-dialog":function(e){t.dialogVisible=!1}}})],1)],1),t._v(" "),i("div",{staticStyle:{"margin-top":"20px"}},[i("el-button",{staticStyle:{position:"relative",left:"-5%"},attrs:{type:"primary",icon:"el-icon-check",plain:"",round:""}},[t._v("确认")]),t._v(" "),i("el-button",{staticStyle:{position:"relative",left:"5%"},attrs:{type:"primary",icon:"el-icon-delete",plain:"",round:""},on:{click:t.deleteAll}},[t._v("清空")])],1)])},staticRenderFns:[]};var f={data:function(){return{activeName:"upload"}},components:{imgManager:d,thumbnail:l,result:i("VU/8")(m,p,!1,function(t){i("V4jg")},"data-v-73c8141b",null).exports},mounted:function(){},computed:{},methods:{handleClick:function(t,e){}}},v={render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",[i("el-tabs",{staticStyle:{position:"absolute",width:"80%",left:"10%",top:"10%"},on:{"tab-click":t.handleClick},model:{value:t.activeName,callback:function(e){t.activeName=e},expression:"activeName"}},[i("el-tab-pane",{attrs:{label:"上传预览",name:"upload"}},[i("thumbnail")],1),t._v(" "),i("el-tab-pane",{attrs:{label:"识别结果",name:"result"}},[i("result")],1)],1)],1)},staticRenderFns:[]};var g=i("VU/8")(f,v,!1,function(t){i("gzIi")},"data-v-c50d0aec",null);e.default=g.exports},V4jg:function(t,e){},gzIi:function(t,e){},phgo:function(t,e){},vkan:function(t,e){}});
//# sourceMappingURL=0.338ea6f36daaaea7f43a.js.map